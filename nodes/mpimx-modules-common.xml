<?xml version="1.0" standalone="no"?>

<kickstart>

<description>
MPI libraries for MX
</description>

<copyright>
Copyright (c) 2000 - 2008 The Regents of the University of California.
All rights reserved. Rocks(r) v5.1 www.rocksclusters.org
</copyright>

<changelog>
</changelog>

<post>

# MPICH

/bin/mkdir -m 0755 -p /opt/modulefiles/mpi/mpich_mx

<file name="/opt/modulefiles/mpi/mpich_mx/1.2.7" perms="0644">
#%Module1.0
set mpich_mxHome /opt/mpich_mx
set compiler [expr ! [catch {exec which icc} ignored] ? {"intel"} : \
                   ! [catch {exec which pgcc} ignored] ? {"pgi"} : {"gnu"}]
set suffix [expr {$compiler} == {"gnu"} ? {""} : {"$compiler"}]
module-whatis "mpich_mx mpi stack"
module-whatis "Version: 1.2.7"
prepend-path PATH $mpich_mxHome/bin$suffix
prepend-path LD_LIBRARY_PATH $mpich_mxHome/lib$suffix
</file>

<file name="/opt/modulefiles/mpi/mpich_mx/.version.1.2.7">
#%Module1.0
set ModulesVersion "1.2.7"
</file>

/bin/ln -s /opt/modulefiles/mpi/mpich_mx/.version.1.2.7 \
           /opt/modulefiles/mpi/mpich_mx/.version

# MPICH2

/bin/mkdir -m 0755 -p /opt/modulefiles/mpi/mpich2_mx

<file name="/opt/modulefiles/mpi/mpich2_mx/1.0.7" perms="0644">
#%Module1.0
set mpich2_mxHome /opt/mpich2_mx
set compiler [expr ! [catch {exec which icc} ignored] ? {"intel"} : \
                   ! [catch {exec which pgcc} ignored] ? {"pgi"} : {"gnu"}]
set suffix [expr {$compiler} == {"gnu"} ? {""} : {"$compiler"}]
module-whatis "mpich2_mx mpi stack"
module-whatis "Version: 1.0.7"
prepend-path PATH $mpich2_mxHome/bin$suffix
prepend-path LD_LIBRARY_PATH $mpich2_mxHome/lib$suffix
</file>

<file name="/opt/modulefiles/mpi/mpich2_mx/.version.1.0.7">
#%Module1.0
set ModulesVersion "1.0.7"
</file>

/bin/ln -s /opt/modulefiles/mpi/mpich2_mx/.version.1.0.7 \
           /opt/modulefiles/mpi/mpich2_mx/.version

# OPENMPI

/bin/mkdir -m 0755 -p /opt/modulefiles/mpi/openmpi_mx

<file name="/opt/modulefiles/mpi/openmpi_mx/1.3.3" perms="0644">
#%Module1.0
set openmpi_mxHome /opt/openmpi_mx
set compiler [expr ! [catch {exec which icc} ignored] ? {"intel"} : \
                   ! [catch {exec which pgcc} ignored] ? {"pgi"} : {"gnu"}]
set suffix [expr {$compiler} == {"gnu"} ? {""} : {"/$compiler"}]
module-whatis "openmpi_mx mpi stack"
module-whatis "Version: 1.3.3"
prepend-path PATH $openmpi_mxHome/bin$suffix
prepend-path LD_LIBRARY_PATH $openmpi_mxHome/lib$suffix
</file>

<file name="/opt/modulefiles/mpi/openmpi_mx/.version.1.3.3">
#%Module1.0
set ModulesVersion "1.3.3"
</file>

/bin/ln -s /opt/modulefiles/mpi/openmpi_mx/.version.1.3.3 \
           /opt/modulefiles/mpi/openmpi_mx/.version

</post>

</kickstart>
